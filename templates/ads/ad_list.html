<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–û–±—ä—è–≤–ª–µ–Ω–∏—è</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f7f8fa;
      margin: 2rem;
    }
    h1 {
      color: #333;
      border-bottom: 2px solid #4caf50;
      padding-bottom: 0.5rem;
    }
    form {
      margin-bottom: 2rem;
    }
    input, select {
      padding: 0.5rem;
      margin-right: 1rem;
    }
    button {
      padding: 0.5rem 1rem;
      background-color: #4caf50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    img {
      max-width: 200px;
      margin-top: 0.5rem;
    }
    .actions a {
      text-decoration: none;
      margin-right: 1rem;
      color: #007bff;
    }
    .actions a:hover {
      text-decoration: underline;
    }
    .buttons {
      margin-top: 2rem;
    }
    .buttons a {
      display: inline-block;
      margin-right: 1rem;
      padding: 0.6rem 1.2rem;
      background-color: #4caf50;
      color: white;
      text-decoration: none;
      border-radius: 5px;
    }
    .buttons a:hover {
      background-color: #45a049;
    }
    .pagination {
      margin-top: 2rem;
    }
    .pagination a {
      text-decoration: none;
      margin-right: 1rem;
      color: #007bff;
    }
    .pagination span {
      margin-right: 1rem;
    }
  </style>
</head>
<body>
  <h1>–û–±—ä—è–≤–ª–µ–Ω–∏—è</h1>

  <!-- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è -->
  <form method="get">
    <input type="text" name="q" placeholder="–ü–æ–∏—Å–∫..." value="{{ query }}">
    <input type="text" name="category" placeholder="–ö–∞—Ç–µ–≥–æ—Ä–∏—è" value="{{ category }}">
    <select name="condition">
      <option value="">–°–æ—Å—Ç–æ—è–Ω–∏–µ (–ª—é–±–æ–µ)</option>
      <option value="new" {% if condition == "new" %}selected{% endif %}>–ù–æ–≤—ã–π</option>
      <option value="used" {% if condition == "used" %}selected{% endif %}>–ë/–£</option>
    </select>
    <button type="submit">–ò—Å–∫–∞—Ç—å</button>
  </form>

  <!-- –°–ø–∏—Å–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π -->
  <ul>
    {% for ad in page_obj %}
      <li>
        <strong>{{ ad.title }}</strong><br>
        {{ ad.description }}<br>
        –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ ad.category }}<br>
        –°–æ—Å—Ç–æ—è–Ω–∏–µ: {{ ad.get_condition_display }}<br>
        –î–∞—Ç–∞: {{ ad.created_at|date:"d.m.Y H:i" }}<br>
        {% if ad.image_url %}
          <img src="{{ ad.image_url }}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
        {% endif %}
        <div class="actions">
          {% if ad.user == request.user %}
            <a href="{% url 'ad_update' ad.id %}">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            <a href="{% url 'ad_delete' ad.id %}">üóë –£–¥–∞–ª–∏—Ç—å</a>
          {% endif %}
        </div>
      </li>
    {% empty %}
      <li>–û–±—ä—è–≤–ª–µ–Ω–∏–π –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</li>
    {% endfor %}
  </ul>

  <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
  <div class="pagination">
    {% if page_obj.has_previous %}
      <a href="?{% if query %}q={{ query }}&{% endif %}{% if category %}category={{ category }}&{% endif %}{% if condition %}condition={{ condition }}&{% endif %}page={{ page_obj.previous_page_number }}">‚Üê –ù–∞–∑–∞–¥</a>
    {% endif %}
    <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a href="?{% if query %}q={{ query }}&{% endif %}{% if category %}category={{ category }}&{% endif %}{% if condition %}condition={{ condition }}&{% endif %}page={{ page_obj.next_page_number }}">–í–ø–µ—Ä—ë–¥ ‚Üí</a>
    {% endif %}
  </div>

  <!-- –ö–Ω–æ–ø–∫–∏ -->
  <div class="buttons">
    <a href="{% url 'ad_create' %}">‚ûï –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</a>
    <a href="{% url 'proposal_create' %}">üîÅ –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –æ–±–º–µ–Ω</a>
    <a href="{% url 'proposal_list' %}">üì¶ –ú–æ–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</a>
    <a href="/api/" style="background-color: #607d8b;">üåê API Root</a>
    {% if request.user.is_authenticated %}
  <form method="post" action="{% url 'logout' %}" style="display:inline;">
    {% csrf_token %}
    <button type="submit" style="
      padding: 0.6rem 1.2rem;
      background-color: #f44336;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    ">
      üö™ –í—ã–π—Ç–∏
    </button>
  </form>
  {% else %}
    <a href="{% url 'login' %}" style="background-color: #2196f3;">üîê –í–æ–π—Ç–∏</a>
  {% endif %}
  </div>
</body>
</html>